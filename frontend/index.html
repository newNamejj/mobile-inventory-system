<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ‰‹æœºè¿›é”€å­˜ç®¡ç†ç³»ç»Ÿ</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
      margin: 0;
      padding: 0;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .container {
      width: 100%;
      max-width: 800px;
      padding: 2rem;
      background: white;
      border-radius: 10px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.1);
    }
    .login-header {
      text-align: center;
      margin-bottom: 2rem;
    }
    .login-header h1 {
      color: #409EFF;
      margin: 0;
      font-size: 1.8rem;
    }
    .login-header p {
      color: #606266;
      margin: 0.5rem 0 0;
    }
    .form-group {
      margin-bottom: 1.5rem;
    }
    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      color: #606266;
      font-weight: 500;
    }
    .form-group input {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid #dcdfe6;
      border-radius: 4px;
      font-size: 1rem;
      transition: border-color 0.25s;
      box-sizing: border-box;
    }
    .form-group input:focus {
      outline: none;
      border-color: #409EFF;
      box-shadow: 0 0 0 2px rgba(64, 158, 255, 0.1);
    }
    .login-button {
      width: 100%;
      padding: 0.75rem;
      background-color: #409EFF;
      color: white;
      border: none;
      border-radius: 4px;
      font-size: 1rem;
      cursor: pointer;
      transition: background-color 0.25s;
    }
    .login-button:hover {
      background-color: #66b1ff;
    }
    .login-button:active {
      background-color: #3a7bd5;
    }
    .status-indicators {
      margin-top: 1.5rem;
      padding: 1rem;
      background-color: #f0f9ff;
      border-radius: 4px;
      border-left: 4px solid #409EFF;
    }
    .status-item {
      display: flex;
      justify-content: space-between;
      padding: 0.25rem 0;
    }
    .status-ok {
      color: #67c23a;
    }
    .status-error {
      color: #f56c6c;
    }
    .nav-button {
      padding: 0.5rem 1rem;
      background-color: #409EFF;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.9rem;
      margin: 0.5rem;
    }
    .nav-button:hover {
      background-color: #66b1ff;
    }
    .nav-button.logout {
      background-color: #f56c6c;
    }
    .nav-button.logout:hover {
      background-color: #f78989;
    }
    .report-section {
      margin: 2rem 0;
      padding: 1rem;
      border: 1px solid #dcdfe6;
      border-radius: 4px;
    }
    .report-actions {
      margin-bottom: 1rem;
      display: flex;
      gap: 0.5rem;
      align-items: center;
      flex-wrap: wrap;
    }
    .action-button {
      padding: 0.5rem 1rem;
      background-color: #67c23a;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    .action-button:hover {
      background-color: #85ce66;
    }
    .report-result {
      margin-top: 1rem;
    }
    .report-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
    }
    .report-table th, .report-table td {
      border: 1px solid #dcdfe6;
      padding: 0.5rem;
      text-align: left;
    }
    .report-table th {
      background-color: #f5f7fa;
    }
    .summary-info {
      background-color: #f0f9ff;
      padding: 1rem;
      border-radius: 4px;
      margin-bottom: 1rem;
    }
    .summary-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      margin: 1rem 0;
    }
    .summary-card {
      background: white;
      padding: 1rem;
      border-radius: 4px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      text-align: center;
    }
    .summary-value {
      font-size: 1.5rem;
      font-weight: bold;
      color: #409EFF;
      margin: 0;
    }
    .error {
      color: #f56c6c;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="container" id="mainContainer">
    <div class="login-header">
      <h1>ğŸ“± æ‰‹æœºè¿›é”€å­˜ç®¡ç†ç³»ç»Ÿ</h1>
      <p>é«˜æ•ˆç®¡ç†æ‚¨çš„æ‰‹æœºåº“å­˜ä¸é”€å”®</p>
    </div>
    
    <form id="loginForm">
      <div class="form-group">
        <label for="username">ç”¨æˆ·å</label>
        <input type="text" id="username" name="username" placeholder="è¯·è¾“å…¥ç”¨æˆ·å" value="admin" required>
      </div>
      
      <div class="form-group">
        <label for="password">å¯†ç </label>
        <input type="password" id="password" name="password" placeholder="è¯·è¾“å…¥å¯†ç " value="admin123" required>
      </div>
      
      <button type="submit" class="login-button">ç™»å½•ç³»ç»Ÿ</button>
    </form>
    
    <div class="status-indicators">
      <h3>ç³»ç»ŸçŠ¶æ€</h3>
      <div class="status-item">
        <span>åç«¯APIæœåŠ¡:</span>
        <span class="status-ok">æ­£å¸¸è¿è¡Œ</span>
      </div>
      <div class="status-item">
        <span>æ•°æ®åº“è¿æ¥:</span>
        <span class="status-ok">æ­£å¸¸</span>
      </div>
      <div class="status-item">
        <span>ç”¨æˆ·è®¤è¯:</span>
        <span class="status-ok">æ­£å¸¸</span>
      </div>
      <div class="status-item">
        <span>APIç«¯ç‚¹:</span>
        <span class="status-ok">å¯è®¿é—®</span>
      </div>
    </div>
  </div>

  <script>
    // æ·»åŠ ä¸€ä¸ªç®€å•çš„è·¯ç”±ç³»ç»Ÿæ¥å¤„ç†ä¸åŒçš„é¡µé¢
    function navigateTo(page) {
      const container = document.getElementById('mainContainer');
      switch(page) {
        case 'dashboard':
          container.innerHTML = `
            <div class="dashboard-header">
              <h1>ğŸ“± æ‰‹æœºè¿›é”€å­˜ç®¡ç†ç³»ç»Ÿ</h1>
              <div style="display: flex; justify-content: space-between; margin-top: 20px; flex-wrap: wrap;">
                <button onclick="navigateTo('reports')" class="nav-button">ğŸ“Š æŠ¥è¡¨ä¸­å¿ƒ</button>
                <button onclick="logout()" class="nav-button logout">ğŸšª é€€å‡ºç™»å½•</button>
              </div>
            </div>
            <div class="dashboard-content">
              <h2>ç³»ç»Ÿæ¦‚è§ˆ</h2>
              <p>æ¬¢è¿ä½¿ç”¨æ‰‹æœºè¿›é”€å­˜ç®¡ç†ç³»ç»Ÿï¼</p>
              <p>ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®è¿›å…¥æŠ¥è¡¨ä¸­å¿ƒæˆ–æ‰§è¡Œå…¶ä»–æ“ä½œã€‚</p>
            </div>
          `;
          break;
        case 'reports':
          container.innerHTML = `
            <div class="reports-header">
              <h1>ğŸ“Š æŠ¥è¡¨ä¸­å¿ƒ</h1>
              <div style="display: flex; justify-content: space-between; margin-top: 20px; flex-wrap: wrap;">
                <button onclick="navigateTo('dashboard')" class="nav-button">ğŸ  è¿”å›é¦–é¡µ</button>
                <button onclick="logout()" class="nav-button logout">ğŸšª é€€å‡ºç™»å½•</button>
              </div>
            </div>
            <div class="reports-content">
              <h2>å„ç±»æŠ¥è¡¨</h2>
              
              <div class="report-section">
                <h3>ğŸ“ˆ é”€å”®æŠ¥è¡¨</h3>
                <div class="report-actions">
                  <input type="date" id="salesStartDate" placeholder="å¼€å§‹æ—¥æœŸ">
                  <input type="date" id="salesEndDate" placeholder="ç»“æŸæ—¥æœŸ">
                  <button onclick="fetchSalesReport()" class="action-button">æŸ¥è¯¢é”€å”®æŠ¥è¡¨</button>
                </div>
                <div id="salesReportResult" class="report-result"></div>
              </div>
              
              <div class="report-section">
                <h3>ğŸ“‰ é‡‡è´­æŠ¥è¡¨</h3>
                <div class="report-actions">
                  <input type="date" id="purchaseStartDate" placeholder="å¼€å§‹æ—¥æœŸ">
                  <input type="date" id="purchaseEndDate" placeholder="ç»“æŸæ—¥æœŸ">
                  <button onclick="fetchPurchaseReport()" class="action-button">æŸ¥è¯¢é‡‡è´­æŠ¥è¡¨</button>
                </div>
                <div id="purchaseReportResult" class="report-result"></div>
              </div>
              
              <div class="report-section">
                <h3>ğŸ“¦ åº“å­˜æŠ¥è¡¨</h3>
                <div class="report-actions">
                  <input type="text" id="inventoryKeyword" placeholder="æœç´¢å‹å·æˆ–å“ç‰Œ">
                  <button onclick="fetchInventoryReport()" class="action-button">æŸ¥è¯¢åº“å­˜æŠ¥è¡¨</button>
                </div>
                <div id="inventoryReportResult" class="report-result"></div>
              </div>
              
              <div class="report-section">
                <h3>ğŸ’° åˆ©æ¶¦æŠ¥è¡¨</h3>
                <div class="report-actions">
                  <input type="date" id="profitStartDate" placeholder="å¼€å§‹æ—¥æœŸ">
                  <input type="date" id="profitEndDate" placeholder="ç»“æŸæ—¥æœŸ">
                  <button onclick="fetchProfitReport()" class="action-button">æŸ¥è¯¢åˆ©æ¶¦æŠ¥è¡¨</button>
                </div>
                <div id="profitReportResult" class="report-result"></div>
              </div>
            </div>
          `;
          break;
      }
    }

    // æŠ¥è¡¨æŸ¥è¯¢å‡½æ•°
    async function fetchSalesReport() {
      const token = localStorage.getItem('token');
      if (!token) {
        alert('è¯·å…ˆç™»å½•');
        navigateTo('login');
        return;
      }

      const startDate = document.getElementById('salesStartDate')?.value;
      const endDate = document.getElementById('salesEndDate')?.value;
      
      try {
        let url = '/api/reports/sales-report';
        const params = new URLSearchParams();
        if (startDate) params.append('startDate', startDate);
        if (endDate) params.append('endDate', endDate);
        if (params.toString()) url += '?' + params.toString();
        
        const response = await fetch(url, {
          method: 'GET',
          headers: {
            'Authorization': `Bearer ${token}`,
            'Content-Type': 'application/json'
          }
        });
        
        const result = await response.json();
        
        if (result.success) {
          displayReportData('salesReportResult', result.data.list, [
            { key: 'order_number', title: 'è®¢å•å·' },
            { key: 'customer_name', title: 'å®¢æˆ·' },
            { key: 'final_amount', title: 'é‡‘é¢', formatter: val => `Â¥${val}` },
            { key: 'created_at', title: 'åˆ›å»ºæ—¶é—´' }
          ], result.data.summary);
        } else {
          document.getElementById('salesReportResult').innerHTML = `<p class="error">æŸ¥è¯¢å¤±è´¥: ${result.message}</p>`;
        }
      } catch (error) {
        console.error('æŸ¥è¯¢é”€å”®æŠ¥è¡¨é”™è¯¯:', error);
        document.getElementById('salesReportResult').innerHTML = '<p class="error">æŸ¥è¯¢é”€å”®æŠ¥è¡¨å¤±è´¥</p>';
      }
    }

    async function fetchPurchaseReport() {
      const token = localStorage.getItem('token');
      if (!token) {
        alert('è¯·å…ˆç™»å½•');
        navigateTo('login');
        return;
      }

      const startDate = document.getElementById('purchaseStartDate')?.value;
      const endDate = document.getElementById('purchaseEndDate')?.value;
      
      try {
        let url = '/api/reports/purchase-report';
        const params = new URLSearchParams();
        if (startDate) params.append('startDate', startDate);
        if (endDate) params.append('endDate', endDate);
        if (params.toString()) url += '?' + params.toString();
        
        const response = await fetch(url, {
          method: 'GET',
          headers: {
            'Authorization': `Bearer ${token}`,
            'Content-Type': 'application/json'
          }
        });
        
        const result = await response.json();
        
        if (result.success) {
          displayReportData('purchaseReportResult', result.data.list, [
            { key: 'order_number', title: 'è®¢å•å·' },
            { key: 'supplier_name', title: 'ä¾›åº”å•†' },
            { key: 'total_amount', title: 'é‡‘é¢', formatter: val => `Â¥${val}` },
            { key: 'created_at', title: 'åˆ›å»ºæ—¶é—´' }
          ], result.data.summary);
        } else {
          document.getElementById('purchaseReportResult').innerHTML = `<p class="error">æŸ¥è¯¢å¤±è´¥: ${result.message}</p>`;
        }
      } catch (error) {
        console.error('æŸ¥è¯¢é‡‡è´­æŠ¥è¡¨é”™è¯¯:', error);
        document.getElementById('purchaseReportResult').innerHTML = '<p class="error">æŸ¥è¯¢é‡‡è´­æŠ¥è¡¨å¤±è´¥</p>';
      }
    }

    async function fetchInventoryReport() {
      const token = localStorage.getItem('token');
      if (!token) {
        alert('è¯·å…ˆç™»å½•');
        navigateTo('login');
        return;
      }

      const keyword = document.getElementById('inventoryKeyword')?.value;
      
      try {
        let url = '/api/reports/inventory-report';
        const params = new URLSearchParams();
        if (keyword) params.append('keyword', keyword);
        if (params.toString()) url += '?' + params.toString();
        
        const response = await fetch(url, {
          method: 'GET',
          headers: {
            'Authorization': `Bearer ${token}`,
            'Content-Type': 'application/json'
          }
        });
        
        const result = await response.json();
        
        if (result.success) {
          displayReportData('inventoryReportResult', result.data.list, [
            { key: 'model_name', title: 'å‹å·' },
            { key: 'brand_name', title: 'å“ç‰Œ' },
            { key: 'quantity', title: 'æ€»åº“å­˜' },
            { key: 'available_quantity', title: 'å¯ç”¨åº“å­˜' },
            { key: 'last_updated', title: 'æœ€åæ›´æ–°' }
          ], result.data.summary);
        } else {
          document.getElementById('inventoryReportResult').innerHTML = `<p class="error">æŸ¥è¯¢å¤±è´¥: ${result.message}</p>`;
        }
      } catch (error) {
        console.error('æŸ¥è¯¢åº“å­˜æŠ¥è¡¨é”™è¯¯:', error);
        document.getElementById('inventoryReportResult').innerHTML = '<p class="error">æŸ¥è¯¢åº“å­˜æŠ¥è¡¨å¤±è´¥</p>';
      }
    }

    async function fetchProfitReport() {
      const token = localStorage.getItem('token');
      if (!token) {
        alert('è¯·å…ˆç™»å½•');
        navigateTo('login');
        return;
      }

      const startDate = document.getElementById('profitStartDate')?.value;
      const endDate = document.getElementById('profitEndDate')?.value;
      
      try {
        let url = '/api/reports/profit-report';
        const params = new URLSearchParams();
        if (startDate) params.append('startDate', startDate);
        if (endDate) params.append('endDate', endDate);
        if (params.toString()) url += '?' + params.toString();
        
        const response = await fetch(url, {
          method: 'GET',
          headers: {
            'Authorization': `Bearer ${token}`,
            'Content-Type': 'application/json'
          }
        });
        
        const result = await response.json();
        
        if (result.success) {
          // æ˜¾ç¤ºåˆ©æ¶¦æ±‡æ€»
          const summaryDiv = document.createElement('div');
          summaryDiv.className = 'profit-summary';
          summaryDiv.innerHTML = `
            <div class="summary-cards">
              <div class="summary-card">
                <h4>æ€»æ”¶å…¥</h4>
                <p class="summary-value">Â¥${result.data.summary.totalRevenue || 0}</p>
              </div>
              <div class="summary-card">
                <h4>æ€»æˆæœ¬</h4>
                <p class="summary-value">Â¥${result.data.summary.totalCost || 0}</p>
              </div>
              <div class="summary-card">
                <h4>æ€»åˆ©æ¶¦</h4>
                <p class="summary-value">Â¥${result.data.summary.totalProfit || 0}</p>
              </div>
              <div class="summary-card">
                <h4>å¹³å‡åˆ©æ¶¦ç‡</h4>
                <p class="summary-value">${result.data.summary.avgProfitMargin || 0}%</p>
              </div>
            </div>
          `;
          
          const targetElement = document.getElementById('profitReportResult');
          targetElement.innerHTML = '';
          targetElement.appendChild(summaryDiv);
          
          // æ˜¾ç¤ºè¯¦ç»†æ•°æ®
          displayReportData('profitReportResult', result.data.list, [
            { key: 'model_name', title: 'å•†å“å‹å·' },
            { key: 'brand_name', title: 'å“ç‰Œ' },
            { key: 'revenue', title: 'é”€å”®æ”¶å…¥', formatter: val => `Â¥${val}` },
            { key: 'cost', title: 'æˆæœ¬', formatter: val => `Â¥${val}` },
            { key: 'profit', title: 'åˆ©æ¶¦', formatter: val => `Â¥${val}` },
            { key: 'profit_margin', title: 'åˆ©æ¶¦ç‡', formatter: val => `${val}%` }
          ], result.data.summary);
        } else {
          document.getElementById('profitReportResult').innerHTML = `<p class="error">æŸ¥è¯¢å¤±è´¥: ${result.message}</p>`;
        }
      } catch (error) {
        console.error('æŸ¥è¯¢åˆ©æ¶¦æŠ¥è¡¨é”™è¯¯:', error);
        document.getElementById('profitReportResult').innerHTML = '<p class="error">æŸ¥è¯¢åˆ©æ¶¦æŠ¥è¡¨å¤±è´¥</p>';
      }
    }

    // é€šç”¨æŠ¥è¡¨æ•°æ®æ˜¾ç¤ºå‡½æ•°
    function displayReportData(containerId, data, columns, summary) {
      const container = document.getElementById(containerId);
      
      // æ¸…é™¤ä¹‹å‰çš„å†…å®¹
      container.innerHTML = '';
      
      // æ˜¾ç¤ºæ±‡æ€»ä¿¡æ¯
      if (summary) {
        let summaryHtml = '<div class="summary-info"><h4>æ±‡æ€»ä¿¡æ¯:</h4><ul>';
        for (const [key, value] of Object.entries(summary)) {
          if (typeof value === 'number') {
            summaryHtml += `<li>${key}: ${key.includes('amount') || key.includes('cost') || key.includes('revenue') || key.includes('profit') ? 'Â¥' : ''}${value}</li>`;
          }
        }
        summaryHtml += '</ul></div>';
        container.innerHTML = summaryHtml;
      }
      
      if (!data || data.length === 0) {
        container.innerHTML += '<p>æš‚æ— æ•°æ®</p>';
        return;
      }
      
      // åˆ›å»ºè¡¨æ ¼
      let tableHtml = '<table class="report-table"><thead><tr>';
      columns.forEach(col => {
        tableHtml += `<th>${col.title}</th>`;
      });
      tableHtml += '</tr></thead><tbody>';
      
      data.slice(0, 20).forEach(item => { // é™åˆ¶æ˜¾ç¤ºå‰20æ¡
        tableHtml += '<tr>';
        columns.forEach(col => {
          let value = item[col.key];
          if (col.formatter) {
            value = col.formatter(value);
          }
          tableHtml += `<td>${value || '-'}</td>`;
        });
        tableHtml += '</tr>';
      });
      
      tableHtml += '</tbody></table>';
      
      if (data.length > 20) {
        tableHtml += `<p>æ˜¾ç¤ºå‰20æ¡ï¼Œå…±${data.length}æ¡è®°å½•</p>`;
      }
      
      container.innerHTML += tableHtml;
    }

    // ç™»å‡ºå‡½æ•°
    function logout() {
      localStorage.removeItem('token');
      navigateTo('login');
    }

    // æ£€æŸ¥ç™»å½•çŠ¶æ€å¹¶å†³å®šæ˜¾ç¤ºå“ªä¸ªé¡µé¢
    function checkAuthAndNavigate() {
      const token = localStorage.getItem('token');
      if (token) {
        // å°è¯•è®¿é—®å—ä¿æŠ¤çš„APIæ¥éªŒè¯token
        fetch('/api/users', {
          headers: {
            'Authorization': `Bearer ${token}`
          }
        })
        .then(response => {
          if (response.ok) {
            navigateTo('dashboard'); // å·²ç™»å½•ï¼Œæ˜¾ç¤ºä»ªè¡¨ç›˜
          } else {
            localStorage.removeItem('token');
            navigateTo('login'); // tokenæ— æ•ˆï¼Œå›åˆ°ç™»å½•é¡µ
          }
        })
        .catch(() => {
          localStorage.removeItem('token');
          navigateTo('login'); // ç½‘ç»œé”™è¯¯ï¼Œå›åˆ°ç™»å½•é¡µ
        });
      } else {
        navigateTo('login'); // æœªç™»å½•ï¼Œæ˜¾ç¤ºç™»å½•é¡µ
      }
    }

    // æ›´æ–°ç™»å½•è¡¨å•æäº¤äº‹ä»¶
    document.addEventListener('DOMContentLoaded', function() {
      const form = document.getElementById('loginForm');
      if (form) {
        form.addEventListener('submit', async function(e) {
          e.preventDefault();
          
          const formData = new FormData(e.target);
          const credentials = {
            username: formData.get('username'),
            password: formData.get('password')
          };
          
          try {
            const response = await fetch('/api/auth/login', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json'
              },
              body: JSON.stringify(credentials)
            });
            
            const result = await response.json();
            
            if (result.success) {
              localStorage.setItem('token', result.data.token);
              alert('ç™»å½•æˆåŠŸï¼æ¬¢è¿ä½¿ç”¨æ‰‹æœºè¿›é”€å­˜ç®¡ç†ç³»ç»Ÿ');
              navigateTo('dashboard');
            } else {
              alert('ç™»å½•å¤±è´¥: ' + result.message);
            }
          } catch (error) {
            console.error('Login error:', error);
            alert('ç™»å½•è¯·æ±‚å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥');
          }
        });
      }
      
      // åˆå§‹åŒ–é¡µé¢
      checkAuthAndNavigate();
    });

    // æ·»åŠ é¡µé¢å¯¼èˆªåŠŸèƒ½
    function navigateTo(page) {
      const container = document.getElementById('mainContainer');
      if (!container) return;
      
      if (page === 'login') {
        container.innerHTML = `
          <div class="login-header">
            <h1>ğŸ“± æ‰‹æœºè¿›é”€å­˜ç®¡ç†ç³»ç»Ÿ</h1>
            <p>é«˜æ•ˆç®¡ç†æ‚¨çš„æ‰‹æœºåº“å­˜ä¸é”€å”®</p>
          </div>
          
          <form id="loginForm">
            <div class="form-group">
              <label for="username">ç”¨æˆ·å</label>
              <input type="text" id="username" name="username" placeholder="è¯·è¾“å…¥ç”¨æˆ·å" value="admin" required>
            </div>
            
            <div class="form-group">
              <label for="password">å¯†ç </label>
              <input type="password" id="password" name="password" placeholder="è¯·è¾“å…¥å¯†ç " value="admin123" required>
            </div>
            
            <button type="submit" class="login-button">ç™»å½•ç³»ç»Ÿ</button>
          </form>
          
          <div class="status-indicators">
            <h3>ç³»ç»ŸçŠ¶æ€</h3>
            <div class="status-item">
              <span>åç«¯APIæœåŠ¡:</span>
              <span class="status-ok">æ­£å¸¸è¿è¡Œ</span>
            </div>
            <div class="status-item">
              <span>æ•°æ®åº“è¿æ¥:</span>
              <span class="status-ok">æ­£å¸¸</span>
            </div>
            <div class="status-item">
              <span>ç”¨æˆ·è®¤è¯:</span>
              <span class="status-ok">æ­£å¸¸</span>
            </div>
            <div class="status-item">
              <span>APIç«¯ç‚¹:</span>
              <span class="status-ok">å¯è®¿é—®</span>
            </div>
          </div>
        `;
        
        // é‡æ–°ç»‘å®šç™»å½•äº‹ä»¶
        document.getElementById('loginForm').addEventListener('submit', async function(e) {
          e.preventDefault();
          
          const formData = new FormData(e.target);
          const credentials = {
            username: formData.get('username'),
            password: formData.get('password')
          };
          
          try {
            const response = await fetch('/api/auth/login', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json'
              },
              body: JSON.stringify(credentials)
            });
            
            const result = await response.json();
            
            if (result.success) {
              localStorage.setItem('token', result.data.token);
              alert('ç™»å½•æˆåŠŸï¼æ¬¢è¿ä½¿ç”¨æ‰‹æœºè¿›é”€å­˜ç®¡ç†ç³»ç»Ÿ');
              navigateTo('dashboard');
            } else {
              alert('ç™»å½•å¤±è´¥: ' + result.message);
            }
          } catch (error) {
            console.error('Login error:', error);
            alert('ç™»å½•è¯·æ±‚å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥');
          }
        });
      } else if (page === 'dashboard') {
        container.innerHTML = `
          <div class="dashboard-header">
            <h1>ğŸ“± æ‰‹æœºè¿›é”€å­˜ç®¡ç†ç³»ç»Ÿ</h1>
            <div style="display: flex; justify-content: space-between; margin-top: 20px; flex-wrap: wrap;">
              <button onclick="navigateTo('reports')" class="nav-button">ğŸ“Š æŠ¥è¡¨ä¸­å¿ƒ</button>
              <button onclick="logout()" class="nav-button logout">ğŸšª é€€å‡ºç™»å½•</button>
            </div>
          </div>
          <div class="dashboard-content">
            <h2>ç³»ç»Ÿæ¦‚è§ˆ</h2>
            <p>æ¬¢è¿ä½¿ç”¨æ‰‹æœºè¿›é”€å­˜ç®¡ç†ç³»ç»Ÿï¼</p>
            <p>ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®è¿›å…¥æŠ¥è¡¨ä¸­å¿ƒæˆ–æ‰§è¡Œå…¶ä»–æ“ä½œã€‚</p>
            <div style="margin-top: 20px;">
              <h3>å¿«é€Ÿæ“ä½œ</h3>
              <ul>
                <li>æŸ¥çœ‹é”€å”®æŠ¥è¡¨</li>
                <li>æŸ¥çœ‹é‡‡è´­æŠ¥è¡¨</li>
                <li>æŸ¥çœ‹åº“å­˜æŠ¥è¡¨</li>
                <li>æŸ¥çœ‹åˆ©æ¶¦æŠ¥è¡¨</li>
              </ul>
            </div>
          </div>
        `;
      } else if (page === 'reports') {
        container.innerHTML = `
          <div class="reports-header">
            <h1>ğŸ“Š æŠ¥è¡¨ä¸­å¿ƒ</h1>
            <div style="display: flex; justify-content: space-between; margin-top: 20px; flex-wrap: wrap;">
              <button onclick="navigateTo('dashboard')" class="nav-button">ğŸ  è¿”å›é¦–é¡µ</button>
              <button onclick="logout()" class="nav-button logout">ğŸšª é€€å‡ºç™»å½•</button>
            </div>
          </div>
          <div class="reports-content">
            <h2>å„ç±»æŠ¥è¡¨</h2>
            
            <div class="report-section">
              <h3>ğŸ“ˆ é”€å”®æŠ¥è¡¨</h3>
              <div class="report-actions">
                <input type="date" id="salesStartDate" placeholder="å¼€å§‹æ—¥æœŸ">
                <input type="date" id="salesEndDate" placeholder="ç»“æŸæ—¥æœŸ">
                <button onclick="fetchSalesReport()" class="action-button">æŸ¥è¯¢é”€å”®æŠ¥è¡¨</button>
              </div>
              <div id="salesReportResult" class="report-result"></div>
            </div>
            
            <div class="report-section">
              <h3>ğŸ“‰ é‡‡è´­æŠ¥è¡¨</h3>
              <div class="report-actions">
                <input type="date" id="purchaseStartDate" placeholder="å¼€å§‹æ—¥æœŸ">
                <input type="date" id="purchaseEndDate" placeholder="ç»“æŸæ—¥æœŸ">
                <button onclick="fetchPurchaseReport()" class="action-button">æŸ¥è¯¢é‡‡è´­æŠ¥è¡¨</button>
              </div>
              <div id="purchaseReportResult" class="report-result"></div>
            </div>
            
            <div class="report-section">
              <h3>ğŸ“¦ åº“å­˜æŠ¥è¡¨</h3>
              <div class="report-actions">
                <input type="text" id="inventoryKeyword" placeholder="æœç´¢å‹å·æˆ–å“ç‰Œ">
                <button onclick="fetchInventoryReport()" class="action-button">æŸ¥è¯¢åº“å­˜æŠ¥è¡¨</button>
              </div>
              <div id="inventoryReportResult" class="report-result"></div>
            </div>
            
            <div class="report-section">
              <h3>ğŸ’° åˆ©æ¶¦æŠ¥è¡¨</h3>
              <div class="report-actions">
                <input type="date" id="profitStartDate" placeholder="å¼€å§‹æ—¥æœŸ">
                <input type="date" id="profitEndDate" placeholder="ç»“æŸæ—¥æœŸ">
                <button onclick="fetchProfitReport()" class="action-button">æŸ¥è¯¢åˆ©æ¶¦æŠ¥è¡¨</button>
              </div>
              <div id="profitReportResult" class="report-result"></div>
            </div>
          </div>
        `;
      }
    }
  </script>
</body>
</html>